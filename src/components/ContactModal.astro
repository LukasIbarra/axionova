---
// Props for customization if needed
export interface Props {
  title?: string;
}

const { title = "Cont√°ctanos" } = Astro.props;
---

<!-- Modal -->
<div id="contactModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
  <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 relative">
    <h3 class="text-2xl font-bold text-blue-600 mb-6 text-center">{title}</h3>
    <form id="contactForm" class="space-y-4">
      <input type="text" placeholder="Nombre" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
      <input type="email" placeholder="Email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
      <textarea placeholder="Mensaje" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none" required></textarea>
      <button type="submit" class="w-full btn-premium btn-premium-orange">Enviar</button>
    </form>
    <button id="closeModal" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const openModalBtns = document.querySelectorAll('#openModal');
    const modal = document.getElementById('contactModal');
    const closeModalBtn = document.getElementById('closeModal');
    const form = document.getElementById('contactForm');

    if (openModalBtns.length > 0 && modal && closeModalBtn && form) {
      // Open modal for each button
      openModalBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          modal.classList.remove('hidden');
          modal.classList.add('show');
        });
      });

      // Close modal
      closeModalBtn.addEventListener('click', function() {
        modal.classList.add('hidden');
        modal.classList.remove('show');
      });

      // Close on outside click
      modal.addEventListener('click', function(e: MouseEvent) {
        if (e.target === modal) {
          modal.classList.add('hidden');
          modal.classList.remove('show');
        }
      });

      // Form submission
      form.addEventListener('submit', function(e: Event) {
        e.preventDefault();
        const formElement = form as HTMLFormElement;
        const nameInput = formElement.querySelector('input[type="text"]') as HTMLInputElement;
        const emailInput = formElement.querySelector('input[type="email"]') as HTMLInputElement;
        const messageTextarea = formElement.querySelector('textarea') as HTMLTextAreaElement;

        const name = nameInput?.value || '';
        const email = emailInput?.value || '';
        const message = messageTextarea?.value || '';

        if (name && email && message) {
          alert(`Gracias, ${name}! Tu mensaje ha sido enviado. Te contactaremos pronto.`);
          formElement.reset();
          modal.classList.add('hidden');
          modal.classList.remove('show');
        } else {
          alert('Por favor, completa todos los campos.');
        }
      });
    }
  });
</script>

<style>
  #contactModal {
    transition: opacity 0.3s ease;
  }
  #contactModal.show {
    display: flex;
  }
</style>
